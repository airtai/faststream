<script>
    // Check if the current path is versioned, if not, redirect to the default versioned path
    const versions = ["0.1", "latest"]
    const defaultVersion = "latest"
    const basePath = "/"
    const targetRedirectPath = "404" // path to redirect to, relative to basePath

    // if path starts with version, redirect to versioned 404
    let foundVersion = false
    versions.forEach(version => {
        const versionedPath = `${basePath}/${version}`;
        console.log("At for loop " + versionedPath)
        if (window.location.pathname.startsWith(versionedPath)) {
             // we need this foundVersion guard because the browser is fast and
             // will keep the executing code below until the redirect happens
            foundVersion = true;
            console.log("At for loop if " + versionedPath)
            window.location.href = `${versionedPath}/${targetRedirectPath}`
        }
    });

    // if path doesn't start with any version, redirect to defaultVersion
    // Replace it in href, so we keep hashes and query params
    // Only replace first occurence of basePath
    if (!foundVersion){
        console.log("At outside if " + basePath)
        window.location.href = window.location.href.replace(basePath, `${basePath}/${defaultVersion}`)
    }
</script>
